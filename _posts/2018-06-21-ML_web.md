---
layout: single
classes: wide
permalink: /RL_proj_SP18/
title: "A Self-driving car simulation using Q-Learning (Spring 2018)"
author_profile: false
header:
  image: "images/senselab1.png"
excerpt: "A Project"
date: 2018-06-21
mathjax: "true"
tags: [Reinforcement Learning, Self-Driving Cars]
font-size: $type-size-8
---


<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="ML_proj.tex"> 
<link rel="stylesheet" type="text/css" href="ML_proj.css"> 
</head><body 
>
<div class="center" 
>
<!--l. 36--><p class="noindent" >
<!--l. 38--><p class="noindent" ><span 
class="cmbx-12x-x-144">A Self-driving car simulation using Q-Learning</span><br />
<!--l. 42--><p class="noindent" ><span 
class="cmbx-10x-x-109">Tushar Agarwal </span><span 
class="cmr-10x-x-109">(agarwal.270@osu.edu), </span><span 
class="cmbx-10x-x-109">Wenxiao Zhan </span><span 
class="cmr-10x-x-109">(zhan.137@osu.edu)</span><br />
</div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Introduction</h3>
<!--l. 48--><p class="noindent" >Creating intelligent machines has long been a human endeavor with a rich past as well as
present. Reinforcement learning is one major component of this endeavor. As the
name suggests, reinforcement learning refers to a reward based learning system
designed for a machine to teach it the correct behavior of acting in a specified
environment. It has its roots in behaviorist psychology and can be simply thought of as
the reward based training routine usually followed while teaching pet animals
like dogs. Such a training requires a time-dependent modeling of the processes.
<br 
class="newline" />
<!--l. 51--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                                    
                                                                                    
<a 
 id="x1-10011"></a>
                                                                                    
                                                                                    
<!--l. 53--><p class="noindent" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">Reinforcement Learning Problem (Image from <span class="cite">[<a 
href="#XDan">1</a>]</span>)</span></div><!--tex4ht:label?: x1-10011 -->
                                                                                    
                                                                                    
<!--l. 55--><p class="indent" >   </div><hr class="endfigure">
<!--l. 57--><p class="noindent" >According to the classical and more theoretical approach , the environment is formulated as
a Markov decision process (MDP) whose solution usually requires Dynamic Programming.
In fact, many reinforcement learning algorithms also utilize dynamic programming
techniques suitable to solve MDPs. But, the main difference between the classical methods
and reinforcement learning algorithms is that the latter does not assume knowledge of an
exact mathematical model of the MDP and they target large MDPs where exact methods
become infeasible. Most practical applications are usually of this scale and thus,
reinforcement learning has proven to be absolutely crucial given its high practical
utility.
<!--l. 60--><p class="noindent" >There are two key components that make reinforcement learning so powerful: the use of
samples to optimize performance and the use of function approximation to deal with large
environments. Some scenarios where it has been used are:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-1003x1">A model of the environment is known, but an analytic solution is not available.
      </li>
      <li 
  class="enumerate" id="x1-1005x2">Only  a  simulation  model  of  the  environment  is  available  (the  subject  of
      simulation-based optimization).
      </li>
      <li 
  class="enumerate" id="x1-1007x3">The only way to collect information about the environment is to interact with it
      like the NASA&#8217;s Mars Rover.</li></ol>
<!--l. 71--><p class="noindent" >The first two of these problems could be considered planning problems since some form
of model is available, but the last one is a genuine learning problem. However,
reinforcement learning converts both planning problems to machine learning problems as
well.
   <h3 class="likesectionHead"><a 
 id="x1-2000"></a>Theoretical Background</h3>
<!--l. 78--><p class="noindent" >A reinforcement learning (RL) agent interacts with its environment in discrete time steps.
At each time <span 
class="cmmi-12">t</span>, the agent receives an observation <span 
class="cmmi-12">o</span><sub><span 
class="cmmi-8">t</span></sub>, which typically includes the
reward <span 
class="cmmi-12">r</span><sub><span 
class="cmmi-8">t</span></sub>. It then chooses an action <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub> from the set of available actions, which is
subsequently sent to the environment. The environment moves to a new state <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub> and
the reward <span 
class="cmmi-12">r</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub> associated with the transition (<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub>) is determined. Let the
set of all possible states be referred as <span 
class="cmmi-12">S </span>and the set of all possible actions as <span 
class="cmmi-12">A</span>.
The goal of a reinforcement learning agent usually is to maximize a cumulative
reward.
<!--l. 80--><p class="noindent" >
   <h4 class="likesubsectionHead"><a 
 id="x1-3000"></a>Components</h4>
<!--l. 81--><p class="noindent" >Important components of an RL agent are the policy, the value function and the
model.
                                                                                    
                                                                                    
      <ul class="itemize1">
      <li class="itemize">The  model  predicts  how  the  environment  will  behave  next.  It  has  2  main
      sub-components:-<br 
class="newline" />The transition probability: <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-50.png" alt="P" class="10-120x-x-50" /></span>(<span 
class="cmmi-12">s,a,s</span><span 
class="cmsy-10x-x-120">&#x2032;</span>) = <span 
class="cmmi-12">P</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub> = <span 
class="cmmi-12">s</span><span 
class="cmsy-10x-x-120">&#x2032;|</span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">s,a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">a</span>)<br 
class="newline" />The Reward: <span 
class="cmmi-12">r</span>(<span 
class="cmmi-12">s,a</span>) = <span 
class="cmmi-12">E</span>[<span 
class="cmmi-12">r</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub><span 
class="cmsy-10x-x-120">|</span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">s,a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">a</span>]
      </li>
      <li class="itemize">The policy <span 
class="cmmi-12">&#x03C0; </span>defines the agents behavior and is a mapping from state <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> to action
      <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub>. It can be be deterministic or probabilistic.<br 
class="newline" />Deterministic policy: <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">&#x03C0;</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>)<br 
class="newline" />Probabilistic policy: <span 
class="cmmi-12">&#x03C0;</span>(<span 
class="cmmi-12">a</span><span 
class="cmsy-10x-x-120">|</span><span 
class="cmmi-12">s</span>) = <span 
class="cmmi-12">P</span>(<span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">a</span><span 
class="cmsy-10x-x-120">|</span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">s</span>)
      </li>
      <li class="itemize">Value  function  is  a  prediction  of  the  future  reward.  It  tries  to  measure  the
      goodness or badness of states <span 
class="cmmi-12">V </span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>) or state-action pairs <span 
class="cmmi-12">q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) to help make a
      decision between available set of actions <span 
class="cmmi-12">A </span>at a given state.<br 
class="newline" />State value function for a given policy <span 
class="cmmi-12">&#x03C0;</span>: <span 
class="cmmi-12">V</span> <sub><span 
class="cmmi-8">&#x03C0;</span></sub>(<span 
class="cmmi-12">s</span>) = <span 
class="cmmi-12">E</span><sub><span 
class="cmmi-8">&#x03C0;</span></sub>[<span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmsy-10x-x-120">|</span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">s</span>]<br 
class="newline" />State-action value function for a given policy <span 
class="cmmi-12">&#x03C0;</span>: <span 
class="cmmi-12">Q</span><sub><span 
class="cmmi-8">&#x03C0;</span></sub>(<span 
class="cmmi-12">s,a</span>) = <span 
class="cmmi-12">E</span><sub><span 
class="cmmi-8">&#x03C0;</span></sub>[<span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmsy-10x-x-120">|</span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">s,a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">a</span>]<br 
class="newline" />
      <!--l. 96--><p class="noindent" >where <span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">r</span><sub><span 
class="cmmi-8">t</span></sub> + <span 
class="cmex-10x-x-120">&#x2211;</span>
  <sub><span 
class="cmmi-8">i&#x003E;t</span></sub><span 
class="cmmi-12">&#x03B3;</span><sup><span 
class="cmmi-8">i</span><span 
class="cmsy-8">-</span><span 
class="cmmi-8">t</span></sup><span 
class="cmmi-12">r</span><sub>
<span 
class="cmmi-8">i</span></sub> is a measure of the cumulative reward. The term
      <span 
class="cmmi-12">&#x03B3; </span><span 
class="cmsy-10x-x-120">&#x2208; </span>[0<span 
class="cmmi-12">, </span>1) is a discount factor used to represent the fact that the present reward
      is more valuable than the future reward as the future is always uncertain. This
      is a very practical assumption and has real life manifestations like time value of
      money in finances. It also allows the cumulative reward to be finite in case of
      infinite time horizon, i.e. when the agent takes actions forever.
      </li></ul>
<!--l. 103--><p class="noindent" >
   <h4 class="likesubsectionHead"><a 
 id="x1-4000"></a>Classical Methods</h4>
<!--l. 105--><p class="noindent" >The classical methods to solve this problem rely on an underlying model of the
interactions of the agent with the environment. The formulation is typically based on an
MDP model of the environment which yield&#8217;s the famous Bellman Optimality
Equation.
   <table 
class="equation"><tr><td><a 
 id="x1-4001r1"></a>
   <center class="math-display" >
<img 
src="ML_proj0x.png" alt="                           &#x2211;
V *(st) = maxat [r(st,at) + &#x03B3;     P (st,at,st+1 )V *(st+1)]
                          st+1&#x2208;S
" class="math-display" ></center></td><td class="equation-label">(1)</td></tr></table>
                                                                                    
                                                                                    
<!--l. 109--><p class="nopar" >
   <table 
class="equation"><tr><td><a 
 id="x1-4002r2"></a>
   <center class="math-display" >
<img 
src="ML_proj1x.png" alt="&#x03C0; (s) = argmax  [r(s,a ) + &#x03B3;  &#x2211;   P (s ,a ,s  )V (s   )]
 *  t       at       t  t              t  t  t+1   * t+1
                             st+1&#x2208;S
" class="math-display" ></center></td><td class="equation-label">(2)</td></tr></table>
<!--l. 112--><p class="nopar" >
<!--l. 115--><p class="noindent" >where <span 
class="cmmi-12">V</span> <sub><span 
class="cmsy-8">*</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>) and <span 
class="cmmi-12">&#x03C0;</span><sub><span 
class="cmsy-8">*</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>) refers to the optimal value functions and optimal policy of the state
<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> at time <span 
class="cmmi-12">t </span>respectively. These equations are usually solved iteratively using dynamic
programming which reduces the complexity of the solution from <span 
class="cmmi-12">O</span>(<span 
class="cmmi-12">m</span><sup><span 
class="cmmi-8">n</span></sup>) to <span 
class="cmmi-12">O</span>(<span 
class="cmmi-12">mn</span><sup><span 
class="cmr-8">2</span></sup>).
where <span 
class="cmmi-12">m,n </span>denote the dimensions of the state space and total no. of time-steps
respectively. These methods have their roots in optimal control theory but recently,
people have started referring them also as Model-Based RL. There is a fundamental
problem in using these methods for practical applications. We don&#8217;t have transition
probabilities available for most unknown or even known environments, making
these methods of limited practical use. This is where model-free methods come to
rescue.
<!--l. 122--><p class="noindent" >
   <h4 class="likesubsectionHead"><a 
 id="x1-5000"></a>Model-Free Methods</h4>
<!--l. 123--><p class="noindent" >Model-Free methods are the ones with most wide practical applications. These methods do
not require any underlying transition probabilities of agent states in the environment. But
they are not exactly model free as we still need the reward information from the
environment. Fortunately, some notion of reward is almost always available or can be
artificially generated based on any prior knowledge of appropriate behavior of the agent in
the specific environment.
<!--l. 125--><p class="noindent" >The basic premise of Model-Free learning is instead of finding the estimates of transition
probabilities, the value function itself is approximated by carrying out experiments. One
major problem is with the form of value function <span 
class="cmmi-12">V</span> <sub><span 
class="cmsy-8">*</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>). Even if it is possible to
approximate it, we will still need <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-50.png" alt="P" class="10-120x-x-50" /></span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub>) to evaluate optimal policy at every time-step
which are not available. So instead, a new value function is defined known as the
state-action value function <span 
class="cmmi-12">Q</span><sub><span 
class="cmsy-8">*</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) which assigns value of to each state action pair instead
of only the state itself.
                                                                                    
                                                                                    
   <center class="math-display" >
<img 
src="ML_proj2x.png" alt="                        &#x2211;
Q (st,at) = r(st,at) + &#x03B3;      P (st,at,st+1 )max [Q(st+1,at+1)]
                                          at+1
                       st+1&#x2208;S
" class="math-display" ></center>
   <table 
class="equation"><tr><td><a 
 id="x1-5001r3"></a>
   <center class="math-display" >
<img 
src="ML_proj3x.png" alt="&#x21D2;  Q (st,at) = stE+1&#x2208;S[r(st,at) + &#x03B3; maaxt+1 (Q (st+1, at+1))]
" class="math-display" ></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 131--><p class="nopar" >
This helps simplify the original formulation considerably because now:-
   <center class="math-display" >
<img 
src="ML_proj4x.png" alt="V*(st) = max Q (st,at)
         at&#x2208;A
" class="math-display" ></center>
   <center class="math-display" >
<img 
src="ML_proj5x.png" alt="&#x03C0;*(st) = argmax  Q (st,at)
           at&#x2208;A  " class="math-display" ></center>
Looking at the definition of the new value functions, it is clear that the estimate would be
just the mean of the random variable <span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">r</span><sub><span 
class="cmmi-8">t</span></sub> + <span 
class="cmex-10x-x-120">&#x2211;</span>
  <sub><span 
class="cmmi-8">i&#x003E;t</span></sub><span 
class="cmmi-12">&#x03B3;</span><sup><span 
class="cmmi-8">i</span><span 
class="cmsy-8">-</span><span 
class="cmmi-8">t</span></sup><span 
class="cmmi-12">r</span><sub>
<span 
class="cmmi-8">i</span></sub> obtained after experiments. So
we approximate the true mean by the empirical mean. The change that occurred with
respect to the original state value function formulation <span 
class="cmmi-12">V </span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>) is that the <span 
class="cmmi-12">E</span>[<span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub>] is now
conditioned on both <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> and <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub> instead of just <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>. So, the empirical estimates of <span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) will
                                                                                    
                                                                                    
form a 2-Dimensional array instead of 1-dimensional array in case of <span 
class="cmmi-12">V </span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>). Now, this
2-dimensional array will be hard to estimate accurately for all possible (<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) pairs as the
dimensionality of state-space and/or action-space may be large. But notice that it is not
actually required to estimate all values. What is finally required are the optimal
values <span 
class="cmmi-12">max</span><sub><span 
class="cmmi-8">a</span><sub><span 
class="cmmi-6">t</span></sub><span 
class="cmsy-8">&#x2208;</span><span 
class="cmmi-8">A</span></sub><span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>). So, all estimates are not actually required. But before
finding all the Q values, it is not possible to decide which are the optimal ones.
This results in the basic &#8217;Chicken or Egg&#8217; problem. One of the solutions to this
Q-value estimation problem is <span 
class="cmmi-12">&#x03F5;</span>-greedy search which will be discussed later in this
section.
<!--l. 139--><p class="noindent" >The task of estimating Q-values is broken down into 2 parts: Evaluation and strategic
Improvement.
<!--l. 142--><p class="noindent" >
   <h5 class="likesubsubsectionHead"><a 
 id="x1-6000"></a>Evaluation</h5>
<!--l. 143--><p class="noindent" >There are two primary methods to estimate value functions:-
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-6002x1">Monte Carlo (MC) Methods and
      </li>
      <li 
  class="enumerate" id="x1-6004x2">Temporal Difference (TD) Methods</li></ol>
<!--l. 149--><p class="noindent" >Learning through Monte Carlo methods is the same approach as estimating the
bias of a coin by repeated tosses. Here, <span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s,a</span>) = <span 
class="cmmi-12">E</span>[<span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmsy-10x-x-120">|</span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">s,a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">a</span>] where <span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> is
the random variable which is observed at the end of each episode. An episode is
defined as the complete duration over which the agent starts from source and
reaches its destination. Multiple complete episodes are run to find the required
estimates.
<!--l. 152--><p class="noindent" >An update rule is used to improve the estimates at the end of each episode. This is the basic
incremental mean rule described as follows. Let <span 
class="cmsy-10x-x-120">{</span><span 
class="cmmi-12">X</span><sub><span 
class="cmmi-8">j</span></sub><span 
class="cmsy-10x-x-120">} </span>be a sequence of random variables.
Then the mean of any <span 
class="cmmi-12">k </span>such random variables can be incrementally updated
as:-
   <center class="math-display" >
<img 
src="ML_proj6x.png" alt="     1 &#x2211;k        1       k&#x2211;-1       1                             1
&#x03BC;k = --    Xj =  -[Xk +     Xj ] = -[Xk + (k - 1)&#x03BC;k -1] = &#x03BC;k -1 +-[Xk - &#x03BC;k -1]
     k j=1       k       j=1       k                             k
" class="math-display" ></center>
                                                                                    
                                                                                    
<!--l. 156--><p class="noindent" >Applying this rule to the problem at hand, the incremental update rule for Q-value function
becomes:-
   <table 
class="equation"><tr><td><a 
 id="x1-6005r4"></a>
   <center class="math-display" >
<img 
src="ML_proj7x.png" alt="                        ----1----
Qn (st,at) = Qo (st,at) + N (st,at)(Gt - Qo (st,at))
" class="math-display" ></center></td><td class="equation-label">(4)</td></tr></table>
<!--l. 160--><p class="nopar" >
where <span 
class="cmmi-12">Q</span><sub><span 
class="cmmi-8">n</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) and <span 
class="cmmi-12">Q</span><sub><span 
class="cmmi-8">o</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) denote new and old estimate of the Q-value at (<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>),
<span 
class="cmmi-12">N</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) denotes total number of times agent passed through the (<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) state-action pair
and <span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> denotes the value obtained at the end of current episode.
<!--l. 163--><p class="noindent" >Notice that this is the exact evaluation of <span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>). From here onward, several steps
will be taken to modify the eq. (4) to make it more conducive for calculations in
real-time.
<!--l. 166--><p class="noindent" >First change that is made will be to use a variable <span 
class="cmmi-12">&#x03B1; </span><span 
class="cmsy-10x-x-120">&#x2208; </span>[0<span 
class="cmmi-12">, </span>1) instead of <img 
src="ML_proj8x.png" alt="---1---
N(st,at)"  class="frac" align="middle"> and in general
<span 
class="cmmi-12">&#x03B1; &#x003E;</span> <img 
src="ML_proj9x.png" alt="N(s1,a)-
   t t"  class="frac" align="middle">. This is done to reduce and eventually remove the contribution of very old
estimates to <span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) evaluation, as time progresses. This is a very practical thing to do
because very old values become meaningless due to the dynamic nature of the
agent-environment interaction.
<!--l. 170--><p class="noindent" >Next, a change will be made to overcome one of the limitations of the Monte-Carlo method.
Notice that the way it is posed, an episode always needs to terminate to obtain the values of
<span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> and make the updates using eq. (4). This may be a very slow process or even impossible
to do in cases of infinite time horizon or processes that do not terminate. So, a modification
needs to be to be done to make the updates online instead of waiting till the end. This is
where the temporal-difference methods are used. The idea is simple, the random
variable <span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> is replaced by <span 
class="cmmi-12">r</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>) + <span 
class="cmmi-12">&#x03B3;Q</span><sub><span 
class="cmmi-8">o</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span><span 
class="cmr-8">+1</span></sub>), an estimate of <span 
class="cmmi-12">G</span><sub><span 
class="cmmi-8">t</span></sub> which is
available at the very next time-step. This time-difference based update exploits the
commonly found Markovian property of the environments. Thus, the update equation
becomes:-
   <table 
class="equation"><tr><td><a 
 id="x1-6006r5"></a>
   <center class="math-display" >
<img 
src="ML_proj10x.png" alt="Qn(st,at) = Qo(st,at) + &#x03B1;[r(st,at) + &#x03B3;Qo (st+1,at+1 - Qo (st,at)]
" class="math-display" ></center></td><td class="equation-label">(5)</td></tr></table>
<!--l. 176--><p class="nopar" >
<!--l. 178--><p class="noindent" >Notice that this makes TD methods faster and more capable in markovian environments but
they have inferior performance compared to MC methods in non-markovian environments.
In practice, it is possible to get the best of both worlds by using TD(<span 
class="cmmi-12">&#x03BB;</span>) methods which
basically making an update after some <span 
class="cmmi-12">&#x03BB; </span>amount of time-steps. These are not discussed in
detail here as they are irrelevant to the project but interested readers are encouraged to
refer to <span class="cite">[<a 
href="#XDaSi">2</a>]</span>.
<!--l. 183--><p class="noindent" >
   <h5 class="likesubsubsectionHead"><a 
 id="x1-7000"></a>Improvement using Exploration-Exploitation</h5>
<!--l. 184--><p class="noindent" >Finding all the Q-values may not be possible and they are not actually required
too. The most important values are the optimal ones. But due to the dilemma
described above, it is not possible to get one without the other. Thus, to solve this
problem the concept of Exploration-Exploitation is utilized via. the <span 
class="cmmi-12">&#x03F5;</span>-greedy search
method. This tries to achieve the best of both worlds:- Exploration: Search for
new action paths through the state-space to reach the destination. Exploitation:
Use the knowledge from the past to improve the estimates of the best possible
paths.
<!--l. 188--><p class="noindent" >The <span 
class="cmmi-12">&#x03F5;</span>-greedy search method is similar to the greedy search where the next action <span 
class="cmmi-12">a </span>is
decided based on the equation <span 
class="cmmi-12">a </span>= <span 
class="cmmi-12">argmax</span><sub><span 
class="cmmi-8">a</span><sub><span 
class="cmmi-6">t</span></sub></sub><span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>). But, to explore new actions which
might be even better than the initially guessed best actions, sometimes (i.e. with probability
<span 
class="cmmi-12">&#x03F5;</span>) the next action is decided randomly instead of a greedy decision. Also, in cases when Q
values at a given state are exactly same for multiple actions, a decision is made
randomly.
<!--l. 192--><p class="noindent" >Though it looks simple, this idea of Exploration-Exploitation has proven to be very effective
in applications. In addition, it has been mathematically proven to eventually converge to
finding the optimal value functions <span class="cite">[<a 
href="#XSutt">3</a>]</span>.
<!--l. 196--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-8000"></a>Experiment</h3>
<!--l. 198--><p class="noindent" >The Q-learning algorithm is applied to make a self-driving car agent learn the decisions to
be made. The environment and simulator were taken from the smartcab project in the
Udacity&#8217;s Github page <span class="cite">[<a 
href="#XUd">4</a>]</span> and have been used as is. An agent class has been implemented
that utilizes the Q-learning algorithm and learns to make appropriate decisions in this
simulated environment. The simulator and hence the entire project is built on python 2.7
and the simulator utilizes the pygame library. The simulator grid-world comprises of straight
single lane roads with traffic signals at every intersection and several other cars
(traffic).
                                                                                    
                                                                                    
<!--l. 200--><p class="noindent" >Driving agent receives numeric (scalar) rewards depending on how &#8217;acceptable&#8217; was the
action. This reward logic is coded in the simulator and is based on U.S. right-of-way rules.
The objective is to construct an optimized Q-Learning driving agent that will navigate a
Smartcab through its environment towards a goal while following these rules. Since the
Smartcab is expected to drive passengers from one location to another, the driving agent
will be evaluated on two very important metrics: Safety and Reliability. A driving agent that
gets the Smartcab to its destination while running red lights or narrowly avoiding accidents
would be considered unsafe. Similarly, a driving agent that frequently fails to reach the
destination in time would be considered unreliable. Maximizing the driving agent&#8217;s safety
and reliability is the only way to ensure that Smartcabs have a permanent place in the
transportation industry. Safety and Reliability are measured using a letter-grade system as
follows:
<!--l. 205--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                                    
                                                                                    
<a 
 id="x1-80012"></a>
                                                                                    
                                                                                    
<!--l. 207--><p class="noindent" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Description of performance grades (Image from &#8217;smartcab.ipynb&#8217; in <span class="cite">[<a 
href="#XUd">4</a>]</span>)</span></div><!--tex4ht:label?: x1-80012 -->
                                                                                    
                                                                                    
<!--l. 209--><p class="indent" >   </div><hr class="endfigure">
<!--l. 211--><p class="noindent" >There is a visualization of the simulation available which has been disabled by default. This
is done to make the simulation run faster and to ensure the simulation runs on any machine
having Python (2.7) without the need of installing pygame library and other dependencies
of the simulation. Optionally, the visualizations can be enabled by setting the
&#8217;display&#8217; flag of the &#8217;Simulator&#8217; object to True. The white vehicle in the visual, is the
Smartcab.
<!--l. 214--><p class="noindent" >The first step is to define the valid actions the agent can take. In this case, a valid action is
one of None <span 
class="cmsy-10x-x-120">&#x21D2; </span>(do nothing), &#8217;left&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>(turn left), &#8217;right&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>(turn right) or &#8217;forward&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>(go
forward). The set of valid actions is referred to as <span 
class="cmmi-12">A</span>.
<!--l. 217--><p class="noindent" >The next step is to decide which inputs are the most essential to include in the state of the
agent. This is a critical step and is similar to feature-engineering in supervised learning. If
all the inputs are naively included in the state, the state-space will be so large that the
learnt Q-values will always be sparse and it would be practically impossible as well as
inefficient to make the agent learn. The driving agent receives the following data from the
environment:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-8003x1">&#8217;waypoint&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>The direction the Smartcab should drive leading to the destination,
      relative to the Smartcab&#8217;s current position in the grid-world.
      </li>
      <li 
  class="enumerate" id="x1-8005x2">&#8217;inputs&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>The sensor data from the Smartcab. It includes:-
           <ul class="itemize1">
           <li class="itemize">&#8217;light&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>The color of the traffic signal.
           </li>
           <li class="itemize">&#8217;left&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>The intended direction of travel for a vehicle to the Smartcab&#8217;s left.
           Returns None if no vehicle is present.
           </li>
           <li class="itemize">&#8217;right&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>The intended direction of travel for a vehicle to the Smartcab&#8217;s
           right. Returns None if no vehicle is present.
           </li>
           <li class="itemize">&#8217;oncoming&#8217;  <span 
class="cmsy-10x-x-120">&#x21D2; </span>The  intended  direction  of  travel  for  a  vehicle  across  the
           intersection from the Smartcab. Returns None if no vehicle is present.
           </li></ul>
      </li>
      <li 
  class="enumerate" id="x1-8007x3">&#8217;deadline&#8217; <span 
class="cmsy-10x-x-120">&#x21D2; </span>The number of time-steps remaining for the Smartcab to reach the
      destination.</li></ol>
<!--l. 236--><p class="noindent" >Assuming traffic is following regulations, there isn&#8217;t a need of information about the
vehicles on the left and right because the traffic signals take care of it. Hence, out of
these inputs, the inputs chosen to be the part of the state are &#8217;waypoint&#8217;, &#8217;light&#8217;
and &#8217;oncoming&#8217;. &#8217;deadline&#8217; is right now neglected because in authors&#8217; opinion,
safety is more of a concern primarily. If the agent receives decent reliability grade
                                                                                    
                                                                                    
(&#8217;A&#8217; or higher) without including &#8217;deadline&#8217; in the state, then this input will also
be ignored in favor of smaller state-space, less storage requirements and faster
performance.
<!--l. 239--><p class="noindent" >The Q-table is formed as a python dictionary. Each state is a key of the dictionary, and each
value will then be another python dictionary that holds the action and Q-value. Here is an
example:-
<!--l. 242--><p class="noindent" ><span 
class="cmsy-10x-x-120">{ </span>&#8217;state-1&#8217;:  &#8217;action-1&#8217; : Qvalue-1,&#8217;action-2&#8217; : Qvalue-2, ...,<br 
class="newline" />&#8217;state-2&#8217;:  &#8217;action-1&#8217; : Qvalue-1,&#8217;action-2&#8217; : Qvalue-2, ...,<br 
class="newline" />... <span 
class="cmsy-10x-x-120">}</span>
   <h5 class="likesubsubsectionHead"><a 
 id="x1-9000"></a>Varying parameters <span 
class="cmmi-12">&#x03B1; </span>and <span 
class="cmmi-12">&#x03F5;</span></h5>
<!--l. 251--><p class="noindent" >It is necessary to adjust learning parameters so that the driving agent learns both safety and
efficiency and converges close to true optimal values. Typically this step requires a lot of
trial and error, as some settings will invariably make the learning worse. Another thing to
keep in mind is the act of learning itself and the time that this takes. In theory, the agent is
allowed to learn for an incredibly long amount of time. However, another goal
of Q-Learning is to transition from experimenting with unlearned behavior to
acting on learned behavior. For example, always allowing the agent to perform a
random action during training (if <span 
class="cmmi-12">&#x03F5; </span>= 1 and never decays) will certainly make
it learn, but never let it act. Hence, as the number of trials increases, <span 
class="cmmi-12">&#x03F5; </span>should
decrease towards 0. Also, it is desired to slowly decay the learning rate <span 
class="cmmi-12">&#x03B1; </span>towards 0
to converge Q-values to optimum values, otherwise these will keep oscillating.
The agent will be tested on what it has learned after <span 
class="cmmi-12">&#x03F5; </span>has gone below a certain
&#8217;threshold&#8217; (specified as 0.05), i.e. the end of training phase is decided by value of
<span 
class="cmmi-12">&#x03F5;</span>.
<!--l. 253--><p class="noindent" >Designing these decay functions took some time and in the end, the authors came up with
the following functions:-
   <center class="par-math-display" >
<img 
src="ML_proj11x.png" alt="            {
              (0.5&#x2215;(1.2t)) + 0.5                                   t &#x003C;= expriter
&#x03F5;t = f&#x03F5;(t) =                            o                     2
              min {(0.449|cos((90t&#x2215;niter) )|) + 0.051),k&#x2215;(t + 1)}   t &#x003E; expriter
" class="par-math-display" ></center>
<!--l. 260--><p class="nopar" >
<!--l. 262--><p class="indent" >
   <center class="math-display" >
<img 
src="ML_proj12x.png" alt="                    &#x221A; --
&#x03B1;t = f&#x03B1;(t) = min{&#x03B1;,   k&#x2215;(t + 1)}
" class="math-display" ></center>
<!--l. 264--><p class="noindent" >Where <span 
class="cmmi-12">&#x03B1; </span>= 0<span 
class="cmmi-12">.</span>5 is a constant, <span 
class="cmmi-12">n</span><sub><span 
class="cmmi-8">iter</span></sub> is the no. of training iterations desired (<span 
class="cmmi-12">n</span><sub><span 
class="cmmi-8">iter</span></sub> = 300),
<span 
class="cmmi-12">expr</span><sub><span 
class="cmmi-8">iter</span></sub> = <span 
class="cmsy-10x-x-120">&#x230A;</span><span 
class="cmmi-12">n</span><sub><span 
class="cmmi-8">iter</span></sub><span 
class="cmmi-12">&#x2215;</span>10<span 
class="cmsy-10x-x-120">&#x230B; </span>and <span 
class="cmmi-12">k </span>= <span 
class="cmmi-12">tolerance </span><span 
class="cmsy-10x-x-120">&#x00D7; </span>(<span 
class="cmmi-12">n</span><sub><span 
class="cmmi-8">iter</span></sub><sup><span 
class="cmr-8">2</span></sup>) are derived constants.
<!--l. 267--><p class="noindent" >Hence, a total of 300 training trials and 50 testing trials are performed.
<!--l. 271--><p class="noindent" >
   <h5 class="likesubsubsectionHead"><a 
 id="x1-10000"></a>Q-Learning Algorithm</h5>
<!--l. 272--><p class="noindent" >Building upon the theoretical background in the previous section, the final Q-learning
algorithm used is described below as Algorithm <a 
href="#x1-100021">1<!--tex4ht:ref: Q --></a>.
<a 
 id="x1-10001r1"></a>
                                                                                    
                                                                                    
<!--l. 274--><p class="indent" >   <hr class="float"><div class="float" 
>
                                                                                    
                                                                                    
                                                                                    
                                                                                    
   <a 
 id="x1-10003"></a>
   <a 
 id="x1-100021"></a>
   <span 
class="cmmi-12">t </span>= 0;
   <span 
class="cmbx-12">while</span>&#x00A0;<span 
class="cmti-12">t</span>
    <span 
class="cmmi-12">&#x003C;</span>=
    <span 
class="cmti-12">maximum</span>
    <span 
class="cmti-12">no.</span>
    <span 
class="cmti-12">of</span>
    <span 
class="cmti-12">time-steps</span>&#x00A0;<span 
class="cmbx-12">do</span>
    
   <span 
class="cmmi-12">&#x03B1;</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">&#x03B1;</span></sub>(<span 
class="cmmi-12">t</span>);
   <span 
class="cmmi-12">&#x03F5;</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">f</span><sub><span 
class="cmmi-8">&#x03F5;</span></sub>(<span 
class="cmmi-12">t</span>);
   Get
     all
     the
     <span 
class="cmsy-10x-x-120">{</span>available
     inputs<span 
class="cmsy-10x-x-120">}</span>
  from
     environment.;
   Build
     the
     state
     <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub> <span 
class="cmsy-10x-x-120">&#x2282;</span>
  <span 
class="cmsy-10x-x-120">{</span>available
     inputs<span 
class="cmsy-10x-x-120">}</span>.;
   <span 
class="cmbx-12">if</span>&#x00A0;<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><img 
src="ML_proj13x.png" alt="&#x2208;&#x2215;"  class="notin" >
  <span 
class="cmti-12">Q-table</span>&#x00A0;<span 
class="cmbx-12">then</span>
    
   create 
an 
entry 
<span 
class="cmmi-12">Q</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span>) = 0<span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmsy-10x-x-120">&#x2200;</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">A</span>;
   <span 
class="cmbx-12">end</span>
   <span 
class="cmbx-12">if</span>&#x00A0;<span 
class="cmsy-10x-x-120">&#x2203;</span><span style="margin-left:2.6664pt" class="tmspace"></span><span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sub>&#x00A0;<span 
class="cmbx-12">then</span>
    
   <center class="math-display" > 
<img 
src="ML_proj14x.png" alt="Qn (st-1,at-1) = Qo(st-1,at-1)+&#x03B1;t [r(st-1,at-1)+&#x03B3; max (Qo (st,a ))- Qo (st-1,at-1)];
                                                  a&#x2208;A 
" class="math-display" ></center>
   <span 
class="cmbx-12">end</span>
   <span 
class="cmmi-12">p </span>= <span 
class="cmmi-12">uniform</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">randomly</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">from</span><span style="margin-left:2.6108pt" class="tmspace"></span>[0<span 
class="cmmi-12">, </span>1);
   <span 
class="cmbx-12">if</span>&#x00A0;<span 
class="cmmi-12">p &#x003C; &#x03F5;</span><sub><span 
class="cmmi-8">t</span></sub>&#x00A0;<span 
class="cmbx-12">then</span>
    
   <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">uniform</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">randomly</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">from</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmmi-12">x </span>: <span 
class="cmmi-12">x </span>= <span 
class="cmmi-12">Q</span><sub><span 
class="cmmi-8">o</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span>)<span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmsy-10x-x-120">&#x2200;</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">A</span><span 
class="cmsy-10x-x-120">}</span>;
   <span 
class="cmbx-12">else</span>
    
   <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub> = <span 
class="cmmi-12">uniform</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">randomly</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmmi-12">from</span><span style="margin-left:2.6108pt" class="tmspace"></span><span 
class="cmsy-10x-x-120">{</span><span 
class="cmmi-12">x </span>: <span 
class="cmmi-12">x </span>= <span 
class="cmmi-12">argmax</span><sub><span 
class="cmmi-8">a</span><span 
class="cmsy-8">&#x2208;</span><span 
class="cmmi-8">A</span></sub><span 
class="cmmi-12">Q</span><sub><span 
class="cmmi-8">o</span></sub>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span>)<span 
class="cmsy-10x-x-120">}</span>;
   <span 
class="cmbx-12">end</span>
   Receive
     reward
     <span 
class="cmmi-12">r</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>)
     from
     the
     environment
     simulator.;
   <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sub> = <span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub>;
   <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sub> = <span 
class="cmmi-12">a</span><sub><span 
class="cmmi-8">t</span></sub>;
   <span 
class="cmmi-12">r</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span><span 
class="cmsy-8">-</span><span 
class="cmr-8">1</span></sub>) = <span 
class="cmmi-12">r</span>(<span 
class="cmmi-12">s</span><sub><span 
class="cmmi-8">t</span></sub><span 
class="cmmi-12">,a</span><sub><span 
class="cmmi-8">t</span></sub>);
   <span 
class="cmmi-12">t </span>= <span 
class="cmmi-12">t </span>+ 1;
   <span 
class="cmbx-12">end</span>
                       <span 
class="cmbx-12">Algorithm</span><span 
class="cmbx-12">&#x00A0;1:</span>&#x00A0;Q-learning algorithm                        
                                                                                    
                                                                                    
                                                                                    
   </div><hr class="endfloat" />
   <h3 class="likesectionHead"><a 
 id="x1-11000"></a>Results</h3>
<!--l. 308--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                    
                                                                                    
<a 
 id="x1-110013"></a>
                                                                                    
                                                                                    
<!--l. 310--><p class="noindent" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Simulator visualization using pygame</span></div><!--tex4ht:label?: x1-110013 -->
                                                                                    
                                                                                    
<!--l. 312--><p class="noindent" ></div><hr class="endfigure">
<!--l. 315--><p class="indent" >   <hr class="figure"><div class="figure" 
>
                                                                                    
                                                                                    
<a 
 id="x1-110045"></a><a 
 id="x1-15005r1"></a><a 
 id="x1-15157r2"></a>
                                                                                    
                                                                                    
<!--l. 318--><p class="noindent" ><a 
 id="x1-11002r1"></a>
<span 
class="cmr-10x-x-109">Training</span>
<span 
class="cmr-10x-x-109">and</span>
<span 
class="cmr-10x-x-109">Testing</span>
<span 
class="cmr-10x-x-109">Results</span>
<span 
class="cmr-10x-x-109">during</span>
<span 
class="cmr-10x-x-109">learning</span>
<span 
class="cmr-10x-x-109">phase</span><a 
 id="x1-11003r2"></a>
 <span 
class="cmr-10x-x-109">Testing</span>
 <span 
class="cmr-10x-x-109">Results</span>
 <span 
class="cmr-10x-x-109">after</span>
 <span 
class="cmr-10x-x-109">learning</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5: </span><span  
class="content">Results of the simulation</span></div><!--tex4ht:label?: x1-110045 -->
                                                                                    
                                                                                    
<!--l. 322--><p class="indent" >   </div><hr class="endfigure">
<!--l. 324--><p class="indent" >   The experiment is run on a windows 10 PC with Intel Xeon CPU E5-2623 (@ 3 GHz)
and RAM of 32 GB. It takes less than 3 minutes to complete. The results are produced
using a separate &#8217;visuals.py&#8217; module. They are shown in figure <a 
href="#x1-11002r1">4a<!--tex4ht:ref: plot_4 --></a>. All the data shown is the
10-trial rolling average. It can be clearly seen that, during the training phase,
all bad actions including violations and accidents gradually drop down towards
zero. Although there are some violations in the last trial, there are no accidents
whatsoever. The relative frequency here refers to the frequency relative to total
number of actions taken during that trial. The 10-trial rolling average reward
increases from -4 to 2. Similarly, even the reliability goes up to 100%. During the
testing in learning phase, the agent receives the best possible grade of &#8217;A+&#8217; for
safety which was the primary target of the project. Also, the reliability grade is &#8217;A&#8217;
which is satisfactory. In fact, in only 2 out of 50 testing trials, the agent wasn&#8217;t
able to reach the destination within allotted time giving 96% test reliability. The
decay of parameters <span 
class="cmmi-12">&#x03B1; </span>and <span 
class="cmmi-12">&#x03F5; </span>according to the designed decay functions, can also be
seen.
<!--l. 326--><p class="noindent" >After learning phase is finished, the learning of the agent is disabled and the simulation is
ran again to test the performance. These testing results are shown in figure <a 
href="#x1-11003r2">4b<!--tex4ht:ref: plot_5 --></a>. Given the
simplicity of the algorithm and the model itself, these results are pretty convincing for
justifying practical application of Q-learning in general RL problems. The rules learnt by the
agent can be seen in the Q-table python dictionary shown in Appendix listing (<a 
href="#x1-15005r1">1<!--tex4ht:ref: lst:Q-table --></a>) and the
code for this experiment is in listing (<a 
href="#x1-15157r2">2<!--tex4ht:ref: lst:code --></a>).
   <h3 class="likesectionHead"><a 
 id="x1-12000"></a>Conclusion</h3>
<!--l. 333--><p class="noindent" >This project was an attempt to make a basic self-driving car agent using Q-learning which is
a Temporal Difference based learning method. The algorithm was understood and
implemented successfully in python (2.7). The important features that form the state of the
agent at any time &#8217;t&#8217;, were carefully chosen from all the inputs received. The model was
learnt using only 3 features as state , viz., the next way-point, the traffic signal and the
direction of travel of oncoming traffic. As a result, the learning was very fast and took
around 3 minutes with 300 iterations. The performance of the agent, obtained from testing
trials was given grade &#8217;A+&#8217; for Safety and &#8217;A&#8217; for reliability. In fact, the reliability
was 96% with agent failing to reach destination on time in only 1 trial out of
total 50. Thus, it can be concluded that Q-learning is a very simple, elegant and
effective way of learning about the optimum behavior of an agent in an unknown
environment.
<!--l. 335--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-13000"></a>Future Work</h3>
<!--l. 337--><p class="noindent" >This project introduced a very important RL algorithm, Q-learning. There is a lot of active
research going on in this domain, especially in regard to storing state-action pair
values as function approximations. An application based effort is proposed as
follows.
                                                                                    
                                                                                    
<!--l. 339--><p class="noindent" >
   <h5 class="likesubsubsectionHead"><a 
 id="x1-14000"></a>MLP training agent</h5>
<!--l. 341--><p class="noindent" >The authors made an innovative effort to use the Q-learning algorithm to train an RL agent
for tweaking hyper-parameters of a fully connected Multilayer Perceptron. The
rewards were taken as the negative of validation loss. It was assumed that the
perceptron network would have a typical trapezoidal shape with the state-space
defined as <span 
class="cmmi-12">S </span>= <span 
class="cmsy-10x-x-120">{ </span>no. of neurons in first hidden layer (length_in), no. of layers
(depth), no. of neurons in last hidden layer (length_out) <span 
class="cmsy-10x-x-120">}</span>. The action space was
defined as <span 
class="cmmi-12">A </span>= <span 
class="cmsy-10x-x-120">{ </span>increase length_in by 20, decrease length_in by 20, increase depth
by 1, decrease depth by 1, increase length_out by 2, decrease length_out by 2 <span 
class="cmsy-10x-x-120">}</span>.
Although there can be more elegant ways of defining the action space and even the
state-space, the authors tried to keep it simple in the beginning efforts. The agent was
trained for 300 iterations with similar parameters as the smartcab agent described
in this project. A part of the results was good where the agent seemed to learn
that the action of increasing depth was preferred in many scenarios, which we
know to be true in the field. But, the results are below satisfactory at this point.
There is a need of deeper and better understanding of other RL techniques and
modifications to the initial problem definition. Authors will work in this direction in
future.
<!--l. 368--><p class="noindent" >
   <h3 class="likesectionHead"><a 
 id="x1-15000"></a>References</h3>
<!--l. 368--><p class="noindent" >
      <div class="thebibliography">
      <p class="bibitem" ><span class="biblabel">
   [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XDan"></a>Daniel, C. et al. &#8221;Reinforcement Learning for Movement Skills,&#8221; <span 
class="cmti-12">Intelligent</span>
      <span 
class="cmti-12">Autonomous Systems</span>, Technische Universitt Darmstadt, <br 
class="newline" />http://www.ausy.tu-darmstadt.de/uploads/Research/Research/ReinforcementLearning.pdf
      </p>
      <p class="bibitem" ><span class="biblabel">
   [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XDaSi"></a>Silver, D., <span 
class="cmti-12">UCL Course on RL</span>,<br 
class="newline" />http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching
      </p>
      <p class="bibitem" ><span class="biblabel">
   [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XSutt"></a>Sutton, R.S. and Barto, A.G., &#8220;Reinforcement Learning: An Introduction,&#8221;
      <span 
class="cmti-12">The MIT Press</span>, Second Edition, April 2018.
      </p>
      <p class="bibitem" ><span class="biblabel">
   [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XUd"></a>Udacity.com, <span 
class="cmti-12">Project: Train a Smartcab How to Drive</span>,<br 
class="newline" />https://github.com/udacity/machine-learning/tree/master/projects/smartcab ,
      January 2018.
</p>
      </div>
                                                                                    
                                                                                    
<!--l. 384--><p class="indent" >
                                                                                    
                                                                                    
<div class="center" 
>
<!--l. 386--><p class="noindent" >
<!--l. 387--><p class="noindent" ><span 
class="cmbx-12x-x-120">Appendix</span><br />
</div>
   <!--l. 392-->
<a 
 id="x1-15006"></a>
<br />
     <div class="caption" 
><span class="id">Listing&#x00A0;1:
     </span><span  
class="content">Q-Table</span></div><!--tex4ht:label?: x1-15005r --><div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-15007r1"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15008r2"></a></span><span 
class="cmtt-12">/-----------------------------------------</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15009r3"></a></span><span 
class="cmtt-12">|</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">State</span><span 
class="cmtt-12">-</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">rewards</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">from</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">-</span><span 
class="cmtt-12">Learning</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15010r4"></a></span><span 
class="cmtt-12">\-----------------------------------------</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15011r5"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15012r6"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15013r7"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.54</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15014r8"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-10.51</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15015r9"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">0.44</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15016r10"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-36.43</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15017r11"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15018r12"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15019r13"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.72</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15020r14"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-8.35</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15021r15"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.52</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15022r16"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-24.48</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15023r17"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15024r18"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15025r19"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.35</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15026r20"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.46</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15027r21"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.19</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15028r22"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-17.70</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15029r23"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15030r24"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15031r25"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.45</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15032r26"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-24.24</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15033r27"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-5.55</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15034r28"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-15.72</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15035r29"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15036r30"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15037r31"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.66</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15038r32"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-8.53</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15039r33"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.27</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15040r34"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-17.76</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15041r35"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15042r36"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15043r37"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.53</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15044r38"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.29</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15045r39"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.46</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15046r40"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.81</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15047r41"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15048r42"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15049r43"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.26</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15050r44"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-8.22</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15051r45"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-2.27</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15052r46"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-38.65</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15053r47"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15054r48"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15055r49"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.68</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15056r50"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-16.12</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15057r51"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.17</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15058r52"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-10.35</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15059r53"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15060r54"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15061r55"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.19</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15062r56"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.02</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15063r57"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.21</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15064r58"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">1.50</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15065r59"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15066r60"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15067r61"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.68</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15068r62"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-9.33</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15069r63"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-1.45</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15070r64"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-15.50</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15071r65"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15072r66"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15073r67"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.45</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15074r68"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-11.19</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15075r69"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-1.17</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15076r70"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-12.12</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15077r71"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15078r72"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15079r73"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.40</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15080r74"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.85</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15081r75"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.43</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15082r76"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-17.92</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15083r77"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15084r78"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15085r79"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.69</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15086r80"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.54</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15087r81"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.87</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15088r82"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.89</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15089r83"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15090r84"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15091r85"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.52</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15092r86"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.97</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15093r87"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">1.81</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15094r88"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-18.38</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15095r89"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15096r90"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15097r91"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.94</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15098r92"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.69</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15099r93"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">1.72</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15100r94"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-17.31</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15101r95"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15102r96"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15103r97"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.02</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15104r98"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.19</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15105r99"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.31</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15106r100"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-18.56</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15107r101"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15108r102"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15109r103"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.00</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15110r104"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-11.41</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15111r105"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">0.67</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15112r106"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-12.23</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15113r107"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15114r108"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15115r109"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.40</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15116r110"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.50</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15117r111"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.20</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15118r112"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.61</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15119r113"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15120r114"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15121r115"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.14</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15122r116"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">1.88</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15123r117"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.94</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15124r118"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-13.60</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15125r119"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15126r120"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15127r121"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.66</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15128r122"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-18.65</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15129r123"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">0.38</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15130r124"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-22.52</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15131r125"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15132r126"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15133r127"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-3.64</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15134r128"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.06</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15135r129"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.48</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15136r130"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.70</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15137r131"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15138r132"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15139r133"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.05</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15140r134"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-8.44</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15141r135"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-1.13</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15142r136"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-20.02</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15143r137"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15144r138"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">red</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#8217;)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15145r139"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.83</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15146r140"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-23.31</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15147r141"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-8.19</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15148r142"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-37.67</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15149r143"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15150r144"></a></span><span 
class="cmtt-12">(&#8217;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">green</span><span 
class="cmtt-12">&#8217;,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15151r145"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">-2.67</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15152r146"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">forward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">3.15</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15153r147"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">right</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.68</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15154r148"></a></span><span 
class="cmtt-12">--</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">left</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">2.36</span>
   </div>
   <!--l. 544-->
<a 
 id="x1-15157r2"></a>
<a 
 id="x1-15158"></a>
<br />
    <div class="caption" 
><span class="id">Listing&#x00A0;2:
    </span><span  
class="content">Python
    Code</span></div><!--tex4ht:label?: x1-15157r --><div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-15159r1"></a></span><span 
class="cmtt-12">import</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">random</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15160r2"></a></span><span 
class="cmtt-12">from</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">environment</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">import</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Agent</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Environment</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15161r3"></a></span><span 
class="cmtt-12">from</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">planner</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">import</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">RoutePlanner</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15162r4"></a></span><span 
class="cmtt-12">from</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">simulator</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">import</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Simulator</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15163r5"></a></span><span 
class="cmtt-12">import</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">numpy</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">as</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15164r6"></a></span><span 
class="cmtt-12">import</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">visuals</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">as</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">vs</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15165r7"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15166r8"></a></span><span 
class="cmtt-12">class</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">LearningAgent</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">Agent</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15167r9"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">An</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">that</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learns</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">drive</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Smartcab</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">world</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15168r10"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">This</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">object</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">you</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">will</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">be</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">modifying</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15169r11"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15170r12"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">__init__</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">False</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">=1.0,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">=0.5)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15171r13"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">super</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">LearningAgent</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">__init__</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">evironment</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15172r14"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">planner</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">RoutePlanner</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">route</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">planner</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15173r15"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">valid_actions</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">valid_actions</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">valid</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">actions</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15174r16"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15175r17"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">parameters</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15176r18"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Whether</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">expected</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learn</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15177r19"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">dict</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">table</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">which</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">will</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">be</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">dictionary</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">tuples</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15178r20"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Random</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">exploration</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">factor</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15179r21"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Learning</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">factor</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15180r22"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">=0</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">counter</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">table</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15181r23"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15182r24"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15183r25"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">reset</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">destination</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">testing</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">False</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15184r26"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">reset</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">at</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">beginning</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">each</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">trial</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15185r27"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">testing</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">True</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">if</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">testing</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">trials</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">are</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">being</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">used</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15186r28"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">once</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">training</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">trials</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">have</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">completed</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15187r29"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15188r30"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Select</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">destination</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">as</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">new</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">location</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">route</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15189r31"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">planner</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">route_to</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">destination</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15190r32"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15191r33"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Update</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">using</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">decay</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15192r34"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Update</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">additional</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">class</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">parameters</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">as</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">needed</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15193r35"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">If</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">testing</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">True</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">alpha</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">0</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15194r36"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">n_iter</span><span 
class="cmtt-12">=300</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x003E;=20</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15195r37"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">expr_iter</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">n_iter</span><span 
class="cmtt-12">//10</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15196r38"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">k</span><span 
class="cmtt-12">=0.05*(</span><span 
class="cmtt-12">n_iter</span><span 
class="cmtt-12">**2)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15197r39"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">+1;</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15198r40"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15199r41"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">int</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">&#x003C;=</span><span 
class="cmtt-12">expr_iter</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">*((0.5/(1.2**</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">+0.5)</span><span 
class="cmtt-12">+\</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15200r42"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">int</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">&#x003E;</span><span 
class="cmtt-12">expr_iter</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">*</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">min</span><span 
class="cmtt-12">([(0.449*</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">abs</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">cos</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">deg2rad</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">*90/</span><span 
class="cmtt-12">n_iter</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">+0.051)</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">k</span><span 
class="cmtt-12">/(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">+1)</span><span 
class="cmtt-12">**2])</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">update</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15201r43"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15202r44"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">min</span><span 
class="cmtt-12">([</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">,(</span><span 
class="cmtt-12">k</span><span 
class="cmtt-12">**0.5)</span><span 
class="cmtt-12">/(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">t</span><span 
class="cmtt-12">+1)</span><span 
class="cmtt-12">])</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15203r45"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15204r46"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">if</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">testing</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15205r47"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">=0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">=0</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15206r48"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">None</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15207r49"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15208r50"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">build_state</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15209r51"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">build_state</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">when</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">requests</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">data</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">from</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15210r52"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">environment</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">next</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">waypoint</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">intersection</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">inputs</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">deadline</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15211r53"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">are</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">all</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">features</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">available</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15212r54"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15213r55"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Collect</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">data</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">about</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">environment</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15214r56"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">waypoint</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">planner</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">next_waypoint</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">next</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">waypoint</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15215r57"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">inputs</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">sense</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Visual</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">input</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">intersection</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">light</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">traffic</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15216r58"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">deadline</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">get_deadline</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Remaining</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">deadline</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15217r59"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15218r60"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Because</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">aim</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">this</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">project</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">demonstrate</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Reinforcement</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Learning</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">we</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">have</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">not</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">done</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15219r61"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">aggressive</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">feature</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">engineering</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Instead</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">aim</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">was</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">adjust</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">alpha</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15220r62"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">thus</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learn</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">about</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">balance</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">between</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">exploration</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">exploitation</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15221r63"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">With</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">hand</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">engineered</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">features</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">this</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">process</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">may</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">get</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">entirely</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">negated</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15222r64"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15223r65"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">as</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">tuple</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">relevant</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">data</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15224r66"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15225r67"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">waypoint</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">inputs</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">light</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">],</span><span 
class="cmtt-12">inputs</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">oncoming</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">])</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15226r68"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15227r69"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15228r70"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15229r71"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">get_maxQ</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15230r72"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">get_maxQ</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">when</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">asked</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">find</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15231r73"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">maximum</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">value</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">all</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">actions</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">based</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">on</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">smartcab</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15232r74"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15233r75"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Calculate</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">maximum</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">value</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">all</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">actions</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">given</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15234r76"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">maxQ</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">max</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">].</span><span 
class="cmtt-12">values</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15235r77"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15236r78"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">maxQ</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15237r79"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15238r80"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15239r81"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">createQ</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15240r82"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">createQ</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">when</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">generated</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">by</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15241r83"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15242r84"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">In</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">phase</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">check</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">if</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">not</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">table</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15243r85"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">If</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">it</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">not</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">new</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">dictionary</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">that</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15244r86"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Then</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">each</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">available</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">initial</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">value</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">0.0</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15245r87"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15246r88"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">if</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">not</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">in</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15247r89"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">]={</span><span 
class="cmtt-12">k</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">v</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">for</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">k</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">v</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">in</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">zip</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">valid_actions</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">zeros</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">len</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">valid_actions</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">}</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15248r90"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15249r91"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15250r92"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15251r93"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">choose_action</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15252r94"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">greedy</span><span 
class="cmitt-10x-x-120">:</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">choose_action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">when</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">asked</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">choose</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15253r95"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">which</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">take</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">based</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">on</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">smartcab</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15254r96"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15255r97"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15256r98"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15257r99"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">next_waypoint</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">planner</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">next_waypoint</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15258r100"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15259r101"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">When</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">choose</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">random</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">with</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">probability</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15260r102"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Otherwise</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">choose</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">an</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">with</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">highest</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">value</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">current</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15261r103"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">When</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">choosing</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">an</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">with</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">highest</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">value</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">selection</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">made</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">randomly</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">between</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">actions</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">that</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"</span><span 
class="cmitt-10x-x-120">tie</span><span 
class="cmitt-10x-x-120">".</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15262r104"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">all_QVs</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">array</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">].</span><span 
class="cmtt-12">values</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">extract</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">all</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">QVs</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15263r105"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">all_keys</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">np</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">array</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">].</span><span 
class="cmtt-12">keys</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15264r106"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">rand_no</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">random</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">uniform</span><span 
class="cmtt-12">(0,1)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">get</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">random</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">no</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">between</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">[0,1)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15265r107"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15266r108"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">if</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">rand_no</span><span 
class="cmtt-12">&#x003C;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">event</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">with</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">probability</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15267r109"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">apt_acts</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">all_keys</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15268r110"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">else</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15269r111"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">apt_acts</span><span 
class="cmtt-12">=[</span><span 
class="cmtt-12">all_keys</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">i</span><span 
class="cmtt-12">]</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">for</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">i</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">in</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">range</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">len</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">all_QVs</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">\</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15270r112"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">if</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">all_QVs</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">i</span><span 
class="cmtt-12">]==</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">get_maxQ</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">]</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">form</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">list</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">apt</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">actions</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15271r113"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15272r114"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">act_idx</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">random</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">randint</span><span 
class="cmtt-12">(0,</span><span 
class="cmtt-12">len</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">apt_acts</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">-1)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">choose</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">random</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">no</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15273r115"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">apt_acts</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">act_idx</span><span 
class="cmtt-12">]</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15274r116"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15275r117"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15276r118"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15277r119"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">learn</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">reward</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">state_new</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15278r120"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learn</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">after</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">completes</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">an</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15279r121"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">receives</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">reward</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">This</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">does</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">not</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">consider</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">future</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">rewards</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15280r122"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">when</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">conducting</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15281r123"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15282r124"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15283r125"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">When</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">implement</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">value</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">iteration</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">update</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">rule</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15284r126"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">gamma</span><span 
class="cmtt-12">=0.5</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15285r127"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Qnew_opt</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">get_maxQ</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state_new</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15286r128"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Q_0</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">][</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">]</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15287r129"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Q_1</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">Q_0</span><span 
class="cmtt-12">+</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">*(</span><span 
class="cmtt-12">reward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">+</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">gamma</span><span 
class="cmtt-12">*</span><span 
class="cmtt-12">Qnew_opt</span><span 
class="cmtt-12">-</span><span 
class="cmtt-12">Q_0</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">update</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">rule</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15288r130"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">Q</span><span 
class="cmtt-12">[</span><span 
class="cmtt-12">str</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">][</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">]=</span><span 
class="cmtt-12">Q_1</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15289r131"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15290r132"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15291r133"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15292r134"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">def</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">update</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15293r135"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">The</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">update</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">called</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">when</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">time</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">step</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">completed</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15294r136"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">environment</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">given</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">trial</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">This</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">function</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">will</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">build</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15295r137"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">choose</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">an</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">receive</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">reward</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learn</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">if</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">enabled</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15296r138"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15297r139"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">build_state</span><span 
class="cmtt-12">()</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Get</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">current</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15298r140"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">createQ</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">state</span><span 
class="cmitt-10x-x-120">&#8217;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">table</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15299r141"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">if</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">hasattr</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">state_old</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15300r142"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">learn</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">state_old</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">action_old</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">reward_old</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">learn</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15301r143"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">choose_action</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Choose</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">an</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">action</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">using</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">eps</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">greedy</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15302r144"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">reward</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">act</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Receive</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">reward</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15303r145"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15304r146"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">save</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">values</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Q</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learn</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">next</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">time</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">step</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15305r147"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">state_old</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">state</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15306r148"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">reward_old</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">reward</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15307r149"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">self</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">action_old</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">action</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15308r150"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15309r151"></a></span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">return</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15310r152"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15311r153"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15312r154"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">In</span><span 
class="cmitt-10x-x-120">[</span><span 
class="cmitt-10x-x-120">Training</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">phase</span><span 
class="cmitt-10x-x-120">]</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15313r155"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15314r156"></a></span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Driving</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">module</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">for</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">running</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulation</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15315r157"></a></span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Press</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">ESC</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">close</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulation</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">or</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">[</span><span 
class="cmitt-10x-x-120">SPACE</span><span 
class="cmitt-10x-x-120">]</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">pause</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulation</span><span 
class="cmitt-10x-x-120">.</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">"""</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15316r158"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15317r159"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">environment</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15318r160"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Flags</span><span 
class="cmitt-10x-x-120">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15319r161"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">verbose</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">True</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">display</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">additional</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">output</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">from</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulation</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15320r162"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">num_dummies</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">discrete</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">number</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">dummy</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agents</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">environment</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">100</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15321r163"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">grid_size</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">discrete</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">number</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">intersections</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">(</span><span 
class="cmitt-10x-x-120">columns</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">rows</span><span 
class="cmitt-10x-x-120">)</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">(8,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">6)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15322r164"></a></span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Environment</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">verbose</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">False</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15323r165"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15324r166"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">driving</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">object</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15325r167"></a></span><span 
class="cmtt-12">agent</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">create_agent</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">LearningAgent</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">True</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">alpha</span><span 
class="cmtt-12">=0.5,</span><span 
class="cmtt-12">epsilon</span><span 
class="cmtt-12">=1)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15326r168"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15327r169"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Follow</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">driving</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">agent</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15328r170"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Flags</span><span 
class="cmitt-10x-x-120">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15329r171"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">enforce_deadline</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">True</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">enforce</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">a</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">deadline</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">metric</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15330r172"></a></span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">set_primary_agent</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">agent</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15331r173"></a></span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">enforce_deadline</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">True</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15332r174"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15333r175"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Create</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulation</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15334r176"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Flags</span><span 
class="cmitt-10x-x-120">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15335r177"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">update_delay</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">continuous</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">time</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">(</span><span 
class="cmitt-10x-x-120">in</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">seconds</span><span 
class="cmitt-10x-x-120">)</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">between</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">actions</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">2.0</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">seconds</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15336r178"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">display</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">False</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">disable</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">GUI</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">if</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">PyGame</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">enabled</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15337r179"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">log_metrics</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">True</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">log</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">trial</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">and</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulation</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">results</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">/</span><span 
class="cmitt-10x-x-120">logs</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15338r180"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">optimized</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">set</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">True</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">change</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">log</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">file</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">name</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15339r181"></a></span><span 
class="cmtt-12">sim</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Simulator</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">update_delay</span><span 
class="cmtt-12">=0.01,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">log_metrics</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">True</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">display</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">False</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">optimized</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">True</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15340r182"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15341r183"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15342r184"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Run</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">the</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">simulator</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15343r185"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">Flags</span><span 
class="cmitt-10x-x-120">:</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15344r186"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">tolerance</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">epsilon</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">tolerance</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">before</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">beginning</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">testing</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">0.05</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15345r187"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">n_test</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">-</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">discrete</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">number</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">of</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">testing</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">trials</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">to</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">perform</span><span 
class="cmitt-10x-x-120">,</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">default</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">is</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">0</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15346r188"></a></span><span 
class="cmtt-12">sim</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">run</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">n_test</span><span 
class="cmtt-12">=50,</span><span 
class="cmtt-12">tolerance</span><span 
class="cmtt-12">=0.05)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15347r189"></a></span><span 
class="cmtt-12">vs</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">plot_trials</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">sim_improved</span><span 
class="cmtt-12">-</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">csv</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">plot_results</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15348r190"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15349r191"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15350r192"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">In</span><span 
class="cmitt-10x-x-120">[</span><span 
class="cmitt-10x-x-120">Testing</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">phase</span><span 
class="cmitt-10x-x-120">]</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15351r193"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15352r194"></a></span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15353r195"></a></span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">Extra</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">testing</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15354r196"></a></span><span 
class="cmtt-12">agent</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">False</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmitt-10x-x-120">#</span><span 
class="cmitt-10x-x-120">stop</span><span 
class="cmitt-10x-x-120">&#x00A0;</span><span 
class="cmitt-10x-x-120">learning</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15355r197"></a></span><span 
class="cmtt-12">sim_test</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">Simulator</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">env</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">update_delay</span><span 
class="cmtt-12">=0.01,</span><span 
class="cmtt-12">&#x00A0;</span><span 
class="cmtt-12">log_metrics</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">True</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">display</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">False</span><span 
class="cmtt-12">,</span><span 
class="cmtt-12">optimized</span><span 
class="cmtt-12">=</span><span 
class="cmtt-12">True</span><span 
class="cmtt-12">)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15356r198"></a></span><span 
class="cmtt-12">sim_test</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">run</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">n_test</span><span 
class="cmtt-12">=20)</span><span 
class="cmtt-12">&#x00A0;</span><br /><span class="label"><a 
 id="x1-15357r199"></a></span><span 
class="cmtt-12">vs</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">plot_trials</span><span 
class="cmtt-12">(</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">sim_no</span><span 
class="cmtt-12">-</span><span 
class="cmtt-12">learning</span><span 
class="cmtt-12">.</span><span 
class="cmtt-12">csv</span><span 
class="cmtt-12">&#8217;</span><span 
class="cmtt-12">)</span>
   </div>
    
</body></html> 

                                                                                    
                                                                                    
                                                                                    


